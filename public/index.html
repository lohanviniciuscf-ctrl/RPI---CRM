<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CRM Premium</title>

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">

<style>
:root{
  --bg:#0a192f;
  --card:#112240;
  --accent:#64ffda;
  --text:#e6f1ff;
}

*{box-sizing:border-box}

body{
  margin:0;
  font-family:'Poppins',sans-serif;
  background:linear-gradient(135deg,var(--bg),#020c1b);
  color:var(--text);
  transition:.4s;
}

button,input{
  padding:10px;
  border:none;
  border-radius:10px;
  font-family:'Poppins';
}

button{
  cursor:pointer;
  font-weight:600;
  transition:.3s;
}
button:hover{transform:scale(1.05)}

.center{
  min-height:100vh;
  display:flex;
  align-items:center;
  justify-content:center;
}

.box{
  background:var(--card);
  padding:35px;
  border-radius:22px;
  width:380px;
  text-align:center;
  box-shadow:0 25px 60px rgba(0,0,0,.45);
  animation:fade .5s;
}

@keyframes fade{
 from{opacity:0;transform:translateY(20px)}
 to{opacity:1}
}

.hidden{display:none}

header{
  display:flex;
  justify-content:space-between;
  align-items:center;
  margin-bottom:25px;
}

.metrics{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(180px,1fr));
  gap:20px;
  margin-bottom:25px;
}

.metric{
  background:var(--card);
  padding:20px;
  border-radius:20px;
  text-align:center;
  box-shadow:0 15px 35px rgba(0,0,0,.25);
  transition:.3s;
}
.metric:hover{transform:translateY(-6px)}

.metric strong{font-size:22px}

.form{
  background:var(--card);
  padding:20px;
  border-radius:20px;
  margin-bottom:25px;
}

.lead{
  background:#fff;
  color:#000;
  padding:18px;
  border-radius:18px;
  margin-bottom:15px;
  box-shadow:0 10px 30px rgba(0,0,0,.2);
  transition:.3s;
}
.lead:hover{transform:translateY(-5px)}

.lead small{opacity:.6}

.lead button{
  margin-top:10px;
  margin-right:5px;
  font-size:12px;
  padding:6px 12px;
  border-radius:8px;
}

.btn-edit{
  background:#fde68a;
}
.btn-delete{
  background:#fecaca;
}
</style>
</head>

<body>

<div id="envSelect" class="center">
  <div class="box">
    <h2>üåê Escolha o ambiente</h2><br>
    <button style="background:#e7c09b" onclick="selectEnv('Modelle')">üë©‚Äçü¶∞ Modelle Skin</button><br><br>
    <button style="background:#64ffda" onclick="selectEnv('Cia')">üìí Cia & Arte</button><br><br>
    <button style="background:#7dd3fc" onclick="selectEnv('Thalles')">üå¨Ô∏è Thalles Climatiza√ß√£o</button>
  </div>
</div>

<div id="loginScreen" class="center hidden">
  <div class="box">
    <button onclick="backToEnv()">‚¨Ö Voltar</button>
    <h2 id="envTitle"></h2><br>
    <input id="user" placeholder="Usu√°rio"><br><br>
    <input id="pass" type="password" placeholder="Senha"><br><br>
    <button onclick="login()">Entrar</button>
    <div id="loginError"></div>
  </div>
</div>

<div id="app" class="hidden" style="padding:30px">
<header>
  <h2 id="appTitle"></h2>
  <div>
    <button onclick="exportCSV()">‚¨á CSV</button>
    <button onclick="logout()">Sair</button>
  </div>
</header>

<div id="metrics" class="metrics"></div>
<div class="form" id="formArea"></div>
<div id="lista"></div>
</div>

<script>
const users={
 Lohan:{pass:"D9f0da85",env:["Modelle","Cia","Thalles"]},
 Marcus:{pass:"Elistray6001",env:["Cia"]},
 Queila:{pass:"alieuq79",env:["Modelle"]},
 Hamonny:{pass:"climatiza√ß√£o",env:["Thalles"]}
};

let env=null,userAtual=null,pedidos=[];

function themeModelle(){
 document.documentElement.style.setProperty("--bg","#f6e2cf");
 document.documentElement.style.setProperty("--card","#e7c09b");
 document.documentElement.style.setProperty("--accent","#c58c5e");
 document.documentElement.style.setProperty("--text","#000");
}

function themeThalles(){
 document.documentElement.style.setProperty("--bg","#0b1220");
 document.documentElement.style.setProperty("--card","#0f172a");
 document.documentElement.style.setProperty("--accent","#38bdf8");
 document.documentElement.style.setProperty("--text","#e0f2fe");
}

function selectEnv(e){
 env=e;
 envSelect.classList.add("hidden");
 loginScreen.classList.remove("hidden");

 envTitle.innerText =
  e==="Modelle" ? "üë©‚Äçü¶∞ Modelle Skin" :
  e==="Cia" ? "üìí Cia & Arte" :
  "üå¨Ô∏è Thalles Climatiza√ß√£o";
}

function backToEnv(){
 loginScreen.classList.add("hidden");
 envSelect.classList.remove("hidden");
}

function login(){
 if(users[user.value] && users[user.value].pass===pass.value && users[user.value].env.includes(env)){
  userAtual=user.value;
  loginScreen.classList.add("hidden");
  app.classList.remove("hidden");

  appTitle.innerText =
   env==="Modelle" ? "üë©‚Äçü¶∞ Modelle Skin ‚Äî "+userAtual :
   env==="Cia" ? "üìí Cia & Arte ‚Äî "+userAtual :
   "üå¨Ô∏è Thalles Climatiza√ß√£o ‚Äî "+userAtual;

  if(env==="Modelle") themeModelle();
  if(env==="Thalles") themeThalles();

  pedidos=JSON.parse(localStorage.getItem(env+"_"+userAtual))||[];
  render();
 }else loginError.innerText="Login inv√°lido";
}

function logout(){location.reload()}

function save(){
 localStorage.setItem(env+"_"+userAtual,JSON.stringify(pedidos));
}

function addPedido(){
 if(env==="Modelle"){
  pedidos.push({id:Date.now(),desc:desc.value,valor:+valor.value,data:Date.now()});
 }else{
  pedidos.push({
   id:Date.now(),
   desc:desc.value,
   valor:+valor.value,
   custo:+custo.value,
   ordinario:+ordinario.value,
   data:Date.now()
  });
 }
 save();render();
}

function deletePedido(id){
 if(confirm("Deseja excluir este pedido?")){
  pedidos=pedidos.filter(p=>p.id!==id);
  save();render();
 }
}

function editPedido(id){
 const p=pedidos.find(p=>p.id===id);
 p.desc=prompt("Descri√ß√£o:",p.desc) || p.desc;
 p.valor=+prompt("Valor:",p.valor) || p.valor;
 if(env!=="Modelle"){
  p.custo=+prompt("Custo:",p.custo) || p.custo;
  p.ordinario=+prompt("Ordin√°rios:",p.ordinario) || p.ordinario;
 }
 save();render();
}

function render(){
 let total=0,custos=0;
 pedidos.forEach(p=>{
  total+=p.valor;
  if(env!=="Modelle") custos+=(p.custo+p.ordinario);
 });

 let lucro=total-custos;
 let comissao=total*0.01;

 metrics.innerHTML=env==="Modelle"?`
  <div class="metric">Pedidos<br><strong>${pedidos.length}</strong></div>
  <div class="metric">Total<br><strong>R$ ${total.toFixed(2)}</strong></div>
  <div class="metric">Comiss√£o 1%<br><strong>R$ ${comissao.toFixed(2)}</strong></div>
 `:`
  <div class="metric">Pedidos<br><strong>${pedidos.length}</strong></div>
  <div class="metric">Faturamento<br><strong>R$ ${total.toFixed(2)}</strong></div>
  <div class="metric">Custos<br><strong>R$ ${custos.toFixed(2)}</strong></div>
  <div class="metric">Lucro<br><strong>R$ ${lucro.toFixed(2)}</strong></div>
 `;

 formArea.innerHTML=env==="Modelle"?`
  <input id="desc" placeholder="O que √© o pedido"><br><br>
  <input id="valor" type="number" placeholder="Valor do pedido"><br><br>
  <button onclick="addPedido()">Adicionar</button>
 `:`
  <input id="desc" placeholder="Descri√ß√£o do servi√ßo"><br><br>
  <input id="valor" type="number" placeholder="Valor cobrado"><br><br>
  <input id="custo" type="number" placeholder="Custo do material"><br><br>
  <input id="ordinario" type="number" placeholder="Custos operacionais"><br><br>
  <button onclick="addPedido()">Adicionar</button>
 `;

 lista.innerHTML="";
 pedidos.forEach(p=>{
  lista.innerHTML+=`
   <div class="lead">
    <strong>${p.desc}</strong><br>
    üí∞ Valor: R$ ${p.valor}<br>
    ${env!=="Modelle"?`üìâ Custos: R$ ${(p.custo+p.ordinario)}<br>üìà Lucro: R$ ${(p.valor-(p.custo+p.ordinario))}<br>`:""}
    <small>üìÖ ${new Date(p.data).toLocaleDateString()}</small><br>
    <button class="btn-edit" onclick="editPedido(${p.id})">‚úèÔ∏è Editar</button>
    <button class="btn-delete" onclick="deletePedido(${p.id})">üóëÔ∏è Excluir</button>
   </div>
  `;
 });
}

function exportCSV(){
 let csv="Descri√ß√£o,Valor,Data\n";
 if(env!=="Modelle") csv="Descri√ß√£o,Valor,Custo,Ordin√°rios,Lucro,Data\n";

 pedidos.forEach(p=>{
  if(env==="Modelle"){
   csv+=`${p.desc},${p.valor},${new Date(p.data).toLocaleDateString()}\n`;
  }else{
   csv+=`${p.desc},${p.valor},${p.custo},${p.ordinario},${p.valor-(p.custo+p.ordinario)},${new Date(p.data).toLocaleDateString()}\n`;
  }
 });

 const blob=new Blob([csv],{type:"text/csv"});
 const a=document.createElement("a");
 a.href=URL.createObjectURL(blob);
 a.download=env+"_consolidado.csv";
 a.click();
}
</script>

</body>
</html>
